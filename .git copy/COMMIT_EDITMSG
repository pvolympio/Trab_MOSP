melhorias importantes no codigo, esta bem comentado no proprio
